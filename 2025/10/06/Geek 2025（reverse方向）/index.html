<!DOCTYPE html>
<html lang="ch">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>Geek 2025 | 槐序十七&#39;s blog</title>
  
  <meta name="author" content="槐序十七" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Reverse" />
  
  <meta name="description" content="Geek 2025（reverse方向）1.ez_pyyy拿到一个pyc文件，直接丢给网页反编译 完整反编译出来的代码为： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737">
<meta property="og:type" content="article">
<meta property="og:title" content="Geek 2025">
<meta property="og:url" content="http://example.com/2025/10/06/Geek%202025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89/index.html">
<meta property="og:site_name" content="槐序十七&#39;s blog">
<meta property="og:description" content="Geek 2025（reverse方向）1.ez_pyyy拿到一个pyc文件，直接丢给网页反编译 完整反编译出来的代码为： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737">
<meta property="og:locale">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763286792603-20251116175317-74tyrwc.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287117452-20251116175842-bisb8wl.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287180831-20251116175945-3kdq9ug.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287330839-20251116180218-ykb4b9u.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288659383-20251116182424-0df384g.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288722683-20251116182530-sp8s6a0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288834835-20251116182720-x2d7zzr.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288882893-20251116182807-buf4v5y.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288954487-20251116182934-5xcwo9s.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763296256606-20251116203100-3o1ls67.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289170399-20251116183308-0fhidl6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289426253-20251116183712-fsvfrvx.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289894338-20251116184512-37j7ap7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289995094-20251116184643-h5xqb29.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763290974269-20251116190257-dybwg6t.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763291574457-20251116191258-x12gqtb.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763293300313-20251116194148-hzp4w87.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763297949214-20251116205923-73y4oop.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251116210129-uiw3nqf.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763298327106-20251116210530-ummmt9j.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763298436025-20251116210718-txlmkrl.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763299321477-20251116212207-ljk2o04.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763387351692-20251117214916-d3n2j5s.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388161314-20251117220249-j5vzfuy.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251117220606-bpvszwq.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388442246-20251117220726-kop20h0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388683059-20251117221126-zh15xks.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388703915-20251117221147-walwhhy.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251117221822-9pix98j.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-11-17%20215909-20251117220036-aw58zv4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763387917243-20251117215842-tq1vz21.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763644582880-20251120211630-i13tpbx.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763645334307-20251120212857-v3ky6f0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646347158-20251120214557-1iuyhwr.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646560527-20251120214935-ou0eado.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646909695-20251120215515-co1w7be.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763647029474-20251120215713-u27y25l.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763647305144-20251120220155-m0cf4sr.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763952784994-20251124105310-nfymkbr.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763952845080-20251124105413-6jqg280.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953166186-20251124105946-ufzqudd.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953279455-20251124110126-b85ussm.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953319456-20251124110206-ktibpep.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979168895-20251124181254-9ekuzt8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979348287-20251124181554-og3lvbn.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979427301-20251124181714-034gyqp.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979908746-20251124182514-oksn90w.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994063478-20251124222106-rlaj2cg.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994114984-20251124222157-uy4vy16.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994201035-20251124222325-xa8zfol.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994276847-20251124222441-royn4tl.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994314455-20251124222517-rzgb8y3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994402266-20251124222648-x49rw7b.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994504134-20251124222829-bhe3xsc.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994647173-20251124223051-g37xzux.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994956829-20251124223601-5zm16t8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763995060416-20251124223745-ogkuhm7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764067987451-20251125185313-8tpiyue.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764068075022-20251125185441-8sdoswv.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764067918889-20251125185208-ep6acn3.png">
<meta property="article:published_time" content="2025-10-05T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-30T07:37:56.647Z">
<meta property="article:author" content="槐序十七">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763286792603-20251116175317-74tyrwc.png">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner.png');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/222.png');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 7.3.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
    
    
        
            
                
                    <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                
            
        
            
                
                    <li><a href="/archives/"><i class="fa fa-file"></i>档案馆</a></li>
                
            
        
            
                
                    <li><a href="/friends/"><i class="fa fa-paw"></i>好伙伴</a></li>
                
            
        
            
                
                    <li>
                        <a><i class="fa fa-link"></i>链接</a>
                        <ul class="sub-menu">
                            
                                
                            
                                
                                    <li><a target="_blank" rel="noopener" href="https://candinya.com">作者博客</a></li>
                                
                            
                                
                                    <li><a target="_blank" rel="noopener" href="https://github.com/Candinya/Kratos-Rebirth">项目链接</a></li>
                                
                            
                        </ul>
                    </li>
                
            
        
    

                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">槐序十七&#39;s blog</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>槐序十七&#39;s blog</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    
                        

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/me.jpg" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                2
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                1
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                2
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Geek-2025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89"><span class="toc-text">Geek 2025（reverse方向）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ez-pyyy"><span class="toc-text">1.ez_pyyy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A9"><span class="toc-text">2.QYQSの奇妙冒险</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-ezRust"><span class="toc-text">3.ezRust</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-only-flower"><span class="toc-text">4.only_flower</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-encode"><span class="toc-text">5.encode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-ezSMC"><span class="toc-text">6.ezSMC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Gensh1n"><span class="toc-text">7.Gensh1n</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A92"><span class="toc-text">8.QYQSの奇妙冒险2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-stack-bomb"><span class="toc-text">9.stack_bomb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-ez-vm"><span class="toc-text">10.ez_vm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-GeekBinder"><span class="toc-text">11.GeekBinder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-obfuscat3"><span class="toc-text">12.obfuscat3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-reReverse"><span class="toc-text">13.reReverse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E5%9B%BD%E4%BA%A7%E3%81%AE%E5%85%89"><span class="toc-text">14.国产の光</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Lastone"><span class="toc-text">15.Lastone</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-ez-android"><span class="toc-text">16.ez_android</span></a></li></ol></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/WP/">WP</a><span class="category-list-count">2</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/Reverse/" style="font-size: 0.8em;">Reverse</a> <a href="/tags/xctf%E5%88%86%E7%AB%99%E8%B5%9B/" style="font-size: 0.6em;">xctf分站赛</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2025/10/06/L3HCTF%202025/"><i class="fa  fa-book"></i> L3HCTF 2025</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/10/06/Geek%202025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89/"><i class="fa  fa-book"></i> Geek 2025</a>
            
          
        
      </ul>
  </div>
  </aside>

            
    </div>
</section>
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/10/06/Geek%202025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89/">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">Geek 2025</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2025-10-05T16:00:00.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2025-10-06</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">槐序十七</span>
                </li>
                
                    <li>
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~42.70K
                        
                        字
                    </li>
                
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1764488276647"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Geek-2025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">Geek 2025（reverse方向）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ez-pyyy"><span class="toc-number">1.1.</span> <span class="toc-text">1.ez_pyyy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A9"><span class="toc-number">1.2.</span> <span class="toc-text">2.QYQSの奇妙冒险</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-ezRust"><span class="toc-number">1.3.</span> <span class="toc-text">3.ezRust</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-only-flower"><span class="toc-number">1.4.</span> <span class="toc-text">4.only_flower</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-encode"><span class="toc-number">1.5.</span> <span class="toc-text">5.encode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-ezSMC"><span class="toc-number">1.6.</span> <span class="toc-text">6.ezSMC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Gensh1n"><span class="toc-number">1.7.</span> <span class="toc-text">7.Gensh1n</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-QYQS%E3%81%AE%E5%A5%87%E5%A6%99%E5%86%92%E9%99%A92"><span class="toc-number">1.8.</span> <span class="toc-text">8.QYQSの奇妙冒险2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-stack-bomb"><span class="toc-number">1.9.</span> <span class="toc-text">9.stack_bomb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-ez-vm"><span class="toc-number">1.10.</span> <span class="toc-text">10.ez_vm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-GeekBinder"><span class="toc-number">1.11.</span> <span class="toc-text">11.GeekBinder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-obfuscat3"><span class="toc-number">1.12.</span> <span class="toc-text">12.obfuscat3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-reReverse"><span class="toc-number">1.13.</span> <span class="toc-text">13.reReverse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E5%9B%BD%E4%BA%A7%E3%81%AE%E5%85%89"><span class="toc-number">1.14.</span> <span class="toc-text">14.国产の光</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Lastone"><span class="toc-number">1.15.</span> <span class="toc-text">15.Lastone</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-ez-android"><span class="toc-number">1.16.</span> <span class="toc-text">16.ez_android</span></a></li></ol></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h1 id="Geek-2025（reverse方向）"><a href="#Geek-2025（reverse方向）" class="headerlink" title="Geek 2025（reverse方向）"></a>Geek 2025（reverse方向）</h1><h2 id="1-ez-pyyy"><a href="#1-ez-pyyy" class="headerlink" title="1.ez_pyyy"></a>1.ez_pyyy</h2><p>拿到一个pyc文件，直接丢给网页反编译</p>
<p>完整反编译出来的代码为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">cipher = [</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">57</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">101</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">54</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">54</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">54</span>,</span><br><span class="line">    <span class="number">98</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">54</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">53</span>,</span><br><span class="line">    <span class="number">56</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">99</span>,</span><br><span class="line">    <span class="number">54</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">52</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">50</span>,</span><br><span class="line">    <span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex_bytes</span>(<span class="params">s = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> s.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">data = <span class="literal">None</span>, key = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>((<span class="keyword">lambda</span> <span class="number">.0</span> = <span class="literal">None</span>: [ b ^ key <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">.0</span> ])(data))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en3</span>(<span class="params">b = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> b &lt;&lt; <span class="number">4</span> &amp; <span class="number">240</span> | b &gt;&gt; <span class="number">4</span> &amp; <span class="number">15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en33</span>(<span class="params">data = <span class="literal">None</span>, n = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;整体 bitstream 循环左移 n 位&#x27;&#x27;&#x27;</span></span><br><span class="line">    bit_len = <span class="built_in">len</span>(data) * <span class="number">8</span></span><br><span class="line">    n = n % bit_len</span><br><span class="line">    val = <span class="built_in">int</span>.from_bytes(data, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    val = (val &lt;&lt; n | val &gt;&gt; bit_len - n) &amp; (<span class="number">1</span> &lt;&lt; bit_len) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> val.to_bytes(<span class="built_in">len</span>(data), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    data = str_to_hex_bytes(flag)</span><br><span class="line">    data = enc(data, <span class="number">17</span>)</span><br><span class="line">    data = <span class="built_in">bytes</span>((<span class="keyword">lambda</span> <span class="number">.0</span>: [ en3(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">.0</span> ])(data))</span><br><span class="line">    data = data[::-<span class="number">1</span>]</span><br><span class="line">    data = en33(data, <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">if</span> data.<span class="built_in">hex</span>() == cipher:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Correct! &#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Wrong！！！！！！！！&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>该代码对输入进行了五步处理：</p>
<ol>
<li>转化为hex字符串</li>
<li>异或17</li>
<li>高低半字节交换</li>
<li>逆序</li>
<li>循环左移32位</li>
</ol>
<p>逆操作顺序：</p>
<ol>
<li>把密文拼回hex字符串并转成bytes</li>
<li>循环右移32位</li>
<li>逆序</li>
<li>再次进行高低半字节交换（可自反操作）</li>
<li>异或17</li>
<li>最后转回UTF-8</li>
</ol>
<p><strong>EXP：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cipher = [</span><br><span class="line">    <span class="number">48</span>,<span class="number">55</span>,<span class="number">57</span>,<span class="number">50</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">55</span>,<span class="number">101</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">48</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">50</span>,<span class="number">54</span>,<span class="number">53</span>,<span class="number">55</span>,<span class="number">54</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">55</span>,<span class="number">53</span>,<span class="number">54</span>,<span class="number">98</span>,<span class="number">55</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">50</span>,<span class="number">53</span>,<span class="number">56</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">99</span>,<span class="number">54</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">52</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">54</span></span><br><span class="line">]</span><br><span class="line">hexs = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> cipher)</span><br><span class="line">data = <span class="built_in">bytes</span>.fromhex(hexs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_right_bytes</span>(<span class="params">data, n_bits</span>):</span><br><span class="line">    bit_len = <span class="built_in">len</span>(data) * <span class="number">8</span></span><br><span class="line">    n = n_bits % bit_len</span><br><span class="line">    val = <span class="built_in">int</span>.from_bytes(data, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    val = (val &gt;&gt; n) | ((val &lt;&lt; (bit_len - n)) &amp; ((<span class="number">1</span> &lt;&lt; bit_len) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> val.to_bytes(<span class="built_in">len</span>(data), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nibble_swap</span>(<span class="params">b</span>):</span><br><span class="line">    <span class="keyword">return</span> ((b &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0xF0</span>) | ((b &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>)</span><br><span class="line"></span><br><span class="line">d1 = rotate_right_bytes(data, <span class="number">32</span>)   <span class="comment"># 逆 en33</span></span><br><span class="line">d2 = d1[::-<span class="number">1</span>]                       <span class="comment"># 逆序</span></span><br><span class="line">d3 = <span class="built_in">bytes</span>(nibble_swap(b) <span class="keyword">for</span> b <span class="keyword">in</span> d2)  <span class="comment"># 逆 en3</span></span><br><span class="line">flag = <span class="built_in">bytes</span>(b ^ <span class="number">17</span> <span class="keyword">for</span> b <span class="keyword">in</span> d3)      <span class="comment"># 逆 enc (xor 17)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># SYC&#123;jtfgdsfda554_a54d8as53&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="2-QYQSの奇妙冒险"><a href="#2-QYQSの奇妙冒险" class="headerlink" title="2.QYQSの奇妙冒险"></a>2.QYQSの奇妙冒险</h2><p>直接ida打开审代码</p>
<p>主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;QYQS&quot;</span>);</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">16</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">43</span>;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">28</span>;</span><br><span class="line">  v7[<span class="number">5</span>] = <span class="number">3</span>;</span><br><span class="line">  v7[<span class="number">6</span>] = <span class="number">23</span>;</span><br><span class="line">  v7[<span class="number">7</span>] = <span class="number">57</span>;</span><br><span class="line">  v7[<span class="number">8</span>] = <span class="number">6</span>;</span><br><span class="line">  v7[<span class="number">9</span>] = <span class="number">1</span>;</span><br><span class="line">  v7[<span class="number">10</span>] = <span class="number">34</span>;</span><br><span class="line">  v7[<span class="number">11</span>] = <span class="number">41</span>;</span><br><span class="line">  v7[<span class="number">12</span>] = <span class="number">14</span>;</span><br><span class="line">  v7[<span class="number">13</span>] = <span class="number">11</span>;</span><br><span class="line">  v7[<span class="number">14</span>] = <span class="number">45</span>;</span><br><span class="line">  v7[<span class="number">15</span>] = <span class="number">109</span>;</span><br><span class="line">  v7[<span class="number">16</span>] = <span class="number">6</span>;</span><br><span class="line">  v7[<span class="number">17</span>] = <span class="number">32</span>;</span><br><span class="line">  v7[<span class="number">18</span>] = <span class="number">23</span>;</span><br><span class="line">  v7[<span class="number">19</span>] = <span class="number">127</span>;</span><br><span class="line">  v7[<span class="number">20</span>] = <span class="number">56</span>;</span><br><span class="line">  sub_140011320();</span><br><span class="line">  sub_140011235(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(Str) == <span class="number">21</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; ; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = j;</span><br><span class="line">      <span class="keyword">if</span> ( j &gt;= j_strlen(Str) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      Str[j] ^= j;</span><br><span class="line">      v10 = j;</span><br><span class="line">      Str[j] ^= v6[j % <span class="number">4</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; ; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      v10 = k;</span><br><span class="line">      <span class="keyword">if</span> ( k &gt;= j_strlen(Str) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( Str[k] != v7[k] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_140011401(<span class="string">&quot;验证成功\n&quot;</span>);</span><br><span class="line">    sub_1400111C7(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    sub_1400111C7(<span class="string">&quot;\n按任意键退出...&quot;</span>);</span><br><span class="line">    getch();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_5:</span><br><span class="line">    sub_140011401(<span class="string">&quot;验证失败，请获得QYQS授权\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sub_14001136B(v3, &amp;unk_14001C2F0);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先检测输入长度为21，然后对每个字节做两次XOR：</p>
<p>​<code>Str[j] ^= j;  Str[j] ^= v6[j % 4];</code></p>
<p>已知<code>v6 = “QYQS”</code>和密文</p>
<p>直接解密就行</p>
<p><strong>EXP:</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> v6[<span class="number">44</span>] = <span class="string">&quot;QYQS&quot;</span>;</span><br><span class="line">    <span class="type">int</span> v7[<span class="number">21</span>] = &#123;</span><br><span class="line">        <span class="number">2</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">3</span>, <span class="number">23</span>, <span class="number">57</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">41</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">109</span>, <span class="number">6</span>, <span class="number">32</span>, <span class="number">23</span>, <span class="number">127</span>, <span class="number">56</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> array_size = <span class="number">21</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; array_size; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">        v7[j] ^= j;</span><br><span class="line">        v7[j] ^= v6[j % <span class="number">4</span>];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (<span class="type">char</span>)v7[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SYC&#123;I_@m_QyqS_r1GhT?&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="3-ezRust"><a href="#3-ezRust" class="headerlink" title="3.ezRust"></a>3.ezRust</h2><p>Rust语言编写的文件，ida打开审计代码</p>
<p>Shift+F12找到了疑似Base85和Base64码表的字符串</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763286792603-20251116175317-74tyrwc.png" alt="QQ_1763286792603"></p>
<p>跟进继续找，感觉下面这串乱码看起来很像密文，而且也符合Base85的加密规律</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287117452-20251116175842-bisb8wl.png" alt="QQ_1763287117452"></p>
<p>提取密文用cyberchef解密</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287180831-20251116175945-3kdq9ug.png" alt="QQ_1763287180831"></p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{Ohjhhh_y0u_g3t_Ezzzzz3_Ru3t!@}</span></p>
<p>‍</p>
<h2 id="4-only-flower"><a href="#4-only-flower" class="headerlink" title="4.only_flower"></a>4.only_flower</h2><p>ida打开，题目都叫flower了，那还说啥了，去花就完了</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763287330839-20251116180218-ykb4b9u.png" alt="QQ_1763287330839"></p>
<p>去完花就能看到清晰的加密逻辑：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to Flowerdance. Input your flag: &quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !fgets(Buffer, <span class="number">256</span>, __iob[<span class="number">0</span>]._ptr) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(Buffer);</span><br><span class="line">  <span class="keyword">if</span> ( v7 &amp;&amp; Buffer[v7 - <span class="number">1</span>] == <span class="number">10</span> )</span><br><span class="line">    Buffer[--v7] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (checkcheck)(Buffer) )</span><br><span class="line">  &#123;</span><br><span class="line">    Size = <span class="built_in">strlen</span>(Buffer);</span><br><span class="line">    <span class="keyword">if</span> ( Size == <span class="number">28</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Buf1 = <span class="built_in">malloc</span>(<span class="number">0x1Cu</span>);</span><br><span class="line">      <span class="keyword">if</span> ( Buf1 )</span><br><span class="line">      &#123;</span><br><span class="line">        encrypt(Buffer, Buf1, Size);</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(Buf1, &amp;CIPHER, Size) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;Correct! Flowerdance!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;Incorrect. Keep dancing.&quot;</span>);</span><br><span class="line">          hint();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(Buf1);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Wrong length (expected %lu bytes including braces).\n&quot;</span>, <span class="number">28</span>);</span><br><span class="line">      hint();</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Bad format..&quot;</span>);</span><br><span class="line">    hint();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进encrypt函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title function_">encrypt</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">unsigned</span> <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// [esp+18h] [ebp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="built_in">strlen</span>(KEY);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(i + a2) = i + rol8((KEY[i % v4] ^ *(a1 + i)), KEY[i % v4] &amp; <span class="number">7</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加密步骤：  </p>
<ol>
<li>​<code>KEY[i % key_len] ^ a1[i]</code> - 用密钥异或明文字节</li>
<li>​<code>rol8(result, KEY[i % key_len] &amp; 7)</code> - 将结果循环左移 (0-7) 位</li>
<li>​<code>i + result</code> - 再加上索引值</li>
</ol>
<p>逆向操作：</p>
<ol>
<li>减去索引</li>
<li>循环右移</li>
<li>密钥异或</li>
</ol>
<p><strong>EXP：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ror8</span>(<span class="params">value, shift</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;8位循环右移&quot;&quot;&quot;</span></span><br><span class="line">    shift = shift % <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> ((value &gt;&gt; shift) | (value &lt;&lt; (<span class="number">8</span> - shift))) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = []</span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    key_bytes = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        <span class="comment"># 减去索引 i</span></span><br><span class="line">        temp = (ciphertext[i] - i) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 循环右移 (KEY[i % key_len] &amp; 7) 位</span></span><br><span class="line">        shift_amount = key_bytes[i % key_len] &amp; <span class="number">7</span></span><br><span class="line">        temp = ror8(temp, shift_amount)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 密钥异或</span></span><br><span class="line">        plain_byte = temp ^ key_bytes[i % key_len]</span><br><span class="line">        plaintext.append(plain_byte)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CIPHER = [</span><br><span class="line">    <span class="number">0x0A</span>, <span class="number">0x84</span>, <span class="number">0xC2</span>, <span class="number">0x84</span>, <span class="number">0x51</span>, <span class="number">0x48</span>, <span class="number">0x5F</span>, <span class="number">0xF2</span>, <span class="number">0x9E</span>, <span class="number">0x8D</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0x84</span>, <span class="number">0x75</span>, <span class="number">0x67</span>, <span class="number">0x73</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x57</span>, <span class="number">0xD7</span>, <span class="number">0xE6</span>,</span><br><span class="line">    <span class="number">0x14</span>, <span class="number">0x6E</span>, <span class="number">0x77</span>, <span class="number">0xE2</span>, <span class="number">0x29</span>, <span class="number">0xFE</span>, <span class="number">0xDF</span>, <span class="number">0xCC</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">&quot;GEEK2025&quot;</span></span><br><span class="line"></span><br><span class="line">flag_bytes = decrypt(CIPHER, KEY)</span><br><span class="line">flag = flag_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;asdjjasdhjk12wk12ijkejk&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="5-encode"><a href="#5-encode" class="headerlink" title="5.encode"></a>5.encode</h2><p>elf文件，代码很简洁，但是藏了加密逻辑</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288659383-20251116182424-0df384g.png" alt="QQ_1763288659383"></p>
<p>main函数里有个异或0x5A</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288722683-20251116182530-sp8s6a0.png" alt="QQ_1763288722683"></p>
<p>compare函数里藏了个base64，上面的unk_100003EF1双击进去是密文，跟进也能发现base64是没换表的</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288834835-20251116182720-x2d7zzr.png" alt="QQ_1763288834835"></p>
<p>但是在码表上面看到了疑似密钥的字符串，跟进调用密钥的函数</p>
<p>X追踪调用后发现，还有一个enc函数被藏在scanf函数里</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288882893-20251116182807-buf4v5y.png" alt="QQ_1763288882893"></p>
<p>这个加密是一个对密钥进行魔改处理的tea算法</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763288954487-20251116182934-5xcwo9s.png" alt="QQ_1763288954487"></p>
<p>密文密钥和加密逻辑都到手了，接下来就是写解密代码</p>
<p>先用cyberchef解了base64和xor，然后转换一下数据端序组合成4字节为一组</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763296256606-20251116203100-3o1ls67.png" alt="QQ_1763296256606"></p>
<p><strong>EXP：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">tea_decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+D0h] [ebp-2Ch]</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+DCh] [ebp-20h]</span></span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x61C88647</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = (<span class="type">uint32_t</span>)(-(<span class="type">int32_t</span>)(delta * <span class="number">32</span>));</span><br><span class="line">    v6 = *a1;</span><br><span class="line">    v5 = a1[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>( <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        v5 -= (((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)) + v6) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);    </span><br><span class="line">        sum += <span class="number">0x61C88647</span>;</span><br><span class="line">        v6 -= (((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)) + v5) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    *a1 = v6;</span><br><span class="line">    a1[<span class="number">1</span>] = v5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">build_v7_from_key</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span> *key_bytes, <span class="type">uint32_t</span> *v7)</span> <span class="comment">//构造密钥</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> base = <span class="number">4</span> * i;</span><br><span class="line">        <span class="type">uint32_t</span> b0 = key_bytes[base];</span><br><span class="line">        <span class="type">uint32_t</span> b1 = key_bytes[base + <span class="number">1</span>];</span><br><span class="line">        <span class="type">uint32_t</span> b2 = key_bytes[base + <span class="number">2</span>];</span><br><span class="line">        <span class="type">uint32_t</span> b3 = key_bytes[base + <span class="number">3</span>];</span><br><span class="line">        v7[i] = ((b1 &lt;&lt; <span class="number">16</span>) | (b0 &lt;&lt; <span class="number">24</span>) | (b2 &lt;&lt; <span class="number">8</span>) | b3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint8_t</span> key_bytes[<span class="number">16</span>] = &#123;<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;!&#x27;</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>];</span><br><span class="line">    build_v7_from_key(key_bytes, key);</span><br><span class="line"></span><br><span class="line">    <span class="type">uint8_t</span> ciphertext[] = &#123;</span><br><span class="line">        <span class="number">0xe6</span>,<span class="number">0x46</span>,<span class="number">0x8d</span>,<span class="number">0x85</span>,<span class="number">0x18</span>,<span class="number">0xf2</span>,<span class="number">0x9c</span>,<span class="number">0x07</span>,</span><br><span class="line">        <span class="number">0x9d</span>,<span class="number">0xfe</span>,<span class="number">0x6c</span>,<span class="number">0xc2</span>,<span class="number">0x32</span>,<span class="number">0x08</span>,<span class="number">0x10</span>,<span class="number">0xdd</span>,</span><br><span class="line">        <span class="number">0x7a</span>,<span class="number">0x25</span>,<span class="number">0x8f</span>,<span class="number">0x93</span>,<span class="number">0x74</span>,<span class="number">0x0e</span>,<span class="number">0x73</span>,<span class="number">0x86</span>,</span><br><span class="line">        <span class="number">0xb9</span>,<span class="number">0x5c</span>,<span class="number">0x3b</span>,<span class="number">0xf5</span>,<span class="number">0x5f</span>,<span class="number">0x4c</span>,<span class="number">0x22</span>,<span class="number">0x81</span>,</span><br><span class="line">        <span class="number">0xc3</span>,<span class="number">0xca</span>,<span class="number">0x56</span>,<span class="number">0x31</span>,<span class="number">0xa3</span>,<span class="number">0x53</span>,<span class="number">0xa3</span>,<span class="number">0x0b</span>,</span><br><span class="line">        <span class="number">0xfc</span>,<span class="number">0x41</span>,<span class="number">0xfc</span>,<span class="number">0xa6</span>,<span class="number">0xfc</span>,<span class="number">0xc2</span>,<span class="number">0x70</span>,<span class="number">0xbe</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> len = <span class="keyword">sizeof</span>(ciphertext);</span><br><span class="line">    <span class="type">uint8_t</span> plaintext[len];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; i += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v_be[<span class="number">2</span>];</span><br><span class="line">        <span class="comment">// 转换成大端序排列</span></span><br><span class="line">        v_be[<span class="number">0</span>] = ((<span class="type">uint32_t</span>)ciphertext[i] &lt;&lt; <span class="number">24</span>) | ((<span class="type">uint32_t</span>)ciphertext[i + <span class="number">1</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                  ((<span class="type">uint32_t</span>)ciphertext[i + <span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | ciphertext[i + <span class="number">3</span>];</span><br><span class="line">        v_be[<span class="number">1</span>] = ((<span class="type">uint32_t</span>)ciphertext[i + <span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | ((<span class="type">uint32_t</span>)ciphertext[i + <span class="number">5</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                  ((<span class="type">uint32_t</span>)ciphertext[i + <span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | ciphertext[i + <span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">        tea_decrypt(v_be, key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 大端序转换回字节</span></span><br><span class="line">        plaintext[i]     = (v_be[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">1</span>] = (v_be[<span class="number">0</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">2</span>] = (v_be[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">3</span>] = v_be[<span class="number">0</span>] &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">4</span>] = (v_be[<span class="number">1</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">5</span>] = (v_be[<span class="number">1</span>] &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">6</span>] = (v_be[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        plaintext[i + <span class="number">7</span>] = v_be[<span class="number">1</span>] &amp; <span class="number">0xFF</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted hex:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>, plaintext[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\nASCII output:\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> c = plaintext[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (c &gt;= <span class="number">32</span> &amp;&amp; c &lt;= <span class="number">126</span>) ? c : <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SYC&#123;St4nd4rd_Funct10n_N0t_4lw4ys_St4nd4rd&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="6-ezSMC"><a href="#6-ezSMC" class="headerlink" title="6.ezSMC"></a>6.ezSMC</h2><p>ida打开审计代码，联系题目很容易发现.miao段代码是被SMC加密处理过的</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289170399-20251116183308-0fhidl6.png" alt="QQ_1763289170399"></p>
<p>*两种解法：1.动调过掉SMC自解密；2.写ida python代码解密</p>
<p>这里演示第二种解法：</p>
<p>要写代码解密，就得先知道是怎么加密的</p>
<p>跟进miao_encrypt –&gt; miao_xor函数，发现是对这段代码进行了一个异或3的处理</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289426253-20251116183712-fsvfrvx.png" alt="QQ_1763289426253"></p>
<p>然后回去确认.miao段代码的起始地址（0x4A2000）和结束地址（0x4A2200）</p>
<p>接下来就是写ida python代码解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">start_address = <span class="number">0x4A2000</span></span><br><span class="line">end_address = <span class="number">0x4A2200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_address,end_address):</span><br><span class="line">    patch_byte(i, get_wide_byte(i) ^ <span class="number">0x03</span>)</span><br></pre></td></tr></table></figure>

<p>然后回到.miao段重新按P反编译定义一下，就能看到加密逻辑了</p>
<p>这一块是一个没换表的基础base64</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289894338-20251116184512-37j7ap7.png" alt="QQ_1763289894338"></p>
<p>但是下面还有个enc0de函数，里面是一个换表base58</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763289995094-20251116184643-h5xqb29.png" alt="QQ_1763289995094"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763290974269-20251116190257-dybwg6t.png" alt="QQ_1763290974269"></p>
<p>再回去审一下主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">_main(argc, argv, envp);</span><br><span class="line">v17 = <span class="string">&quot;tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Plz input your flag miao: &quot;</span>);</span><br><span class="line">v3 = __acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">fgets(v11, <span class="number">1024</span>, v3);</span><br><span class="line">v11[<span class="built_in">strcspn</span>(v11, <span class="string">&quot;\r\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">v16 = ascii_to_hexbytes(v11, &amp;v10);</span><br><span class="line">v15 = hexstr_to_bytes(v16, &amp;v9);</span><br><span class="line">v8 = <span class="number">17</span>;</span><br><span class="line">init(v7, &amp;v8, <span class="number">1</span>i64);</span><br><span class="line">encode(v7, v15, v9);</span><br><span class="line">v14 = bytes_to_hexstr(v15, v9);</span><br><span class="line">miao_encrypt();</span><br><span class="line">v4 = <span class="built_in">strlen</span>(v14);</span><br><span class="line">v13 = encodee(v14, v4);</span><br><span class="line"><span class="keyword">if</span> ( v13 )</span><br><span class="line">&#123;</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(v13);</span><br><span class="line">  v12 = enc0de(v13, v6);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(v12, v17) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  <span class="built_in">free</span>(v16);</span><br><span class="line">  <span class="built_in">free</span>(v15);</span><br><span class="line">  <span class="built_in">free</span>(v14);</span><br><span class="line">  <span class="built_in">free</span>(v13);</span><br><span class="line">  <span class="built_in">free</span>(v12);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;encodee returned NULL&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进分析上面的init和encode函数，代码实现了经典的RC4算法初始化和加解密，但这个RC4的密钥是单字节17，即0x11（<code>v8 = 17;  init(v7, &amp;v8, 1i64);</code>）</p>
<p>整段主函数的加密流程为：</p>
<ol>
<li>输入转hex字符串</li>
<li>再转成bytes –&gt; data</li>
<li>单字节0x11初始化RC4</li>
<li>对data进行RC4加密</li>
<li>把RC4输出转回hex字符串</li>
<li>smc自解密（把后续要用到的base64算法解密出来）</li>
<li>base64编码</li>
<li>base58编码</li>
</ol>
<p>接下来就是逆向加密顺序写解密代码了</p>
<p>先用cyberchef把换表base58和base64解了</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763291574457-20251116191258-x12gqtb.png" alt="QQ_1763291574457"></p>
<p><strong>EXP:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">HEX_CIPHER = <span class="string">&quot;dfd24c6c33beee2b49329e61186012b05da1542dd3f09fb0e9aed330c87477cc&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">key_bytes: <span class="built_in">bytes</span>, data_bytes: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="comment"># KSA</span></span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    keylen = <span class="built_in">len</span>(key_bytes)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key_bytes[i % keylen]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="comment"># PRGA + XOR</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data_bytes:</span><br><span class="line">        i = (i + <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        j = (j + S[i]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) &amp; <span class="number">0xFF</span>]</span><br><span class="line">        out.append(b ^ K)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    hexstr = HEX_CIPHER.strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(hexstr) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Hex length is odd — check input.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cipher = <span class="built_in">bytes</span>.fromhex(hexstr)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Invalid hex:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    key = <span class="built_in">bytes</span>([<span class="number">0x11</span>])   <span class="comment"># 单字节密钥</span></span><br><span class="line">    plain = rc4_decrypt(key, cipher)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cipher (hex):&quot;</span>, cipher.<span class="built_in">hex</span>())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Plain (hex) :&quot;</span>, plain.<span class="built_in">hex</span>())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Plain (ascii):&quot;</span>, plain.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Plain (ascii):&quot;</span>, plain.decode(<span class="string">&#x27;latin1&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;OHhhhhhhh_y0u_Kn0m_SMCCCC@!&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="7-Gensh1n"><a href="#7-Gensh1n" class="headerlink" title="7.Gensh1n"></a>7.Gensh1n</h2><p>ida打开文件，一开始看到的是一个哈希计算函数，但发现后面的判定有问题</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (v7[j] == global_nodes[<span class="number">16</span> * j])</span><br><span class="line">    &#123;</span><br><span class="line">        v5 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段判断的意思是，如果存在任意一个位置满足<code>v7[j] == global_nodes[16 * j]</code>的条件就判定成功</p>
<p>介于这个奇怪的判定，我觉得这应该不是真正的加密逻辑，我先试了动调，然后发现这个文件动调一次就开一次原神的网页(;｀O´)o</p>
<p>还是回去Shift+F12吧，在字符串列表里找到了另一个判定语句，以及一个疑似密钥的字符串</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763293300313-20251116194148-hzp4w87.png" alt="QQ_1763293300313"></p>
<p>跟踪发现调用这个密钥（arr）的函数是前面的那个init初始化函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">init_node</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      *(<span class="number">16LL</span> * i + a1) = arr[i];</span><br><span class="line">      v1 = <span class="number">16LL</span> * i + a1;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt; <span class="number">6</span> )</span><br><span class="line">        *(v1 + <span class="number">8</span>) = <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        *(v1 + <span class="number">8</span>) = <span class="number">16</span> * (i + <span class="number">1LL</span>) + a1;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v1) = <span class="built_in">puts</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合前面分析，只要输入的8个字符里有任意一个与 <code>&quot;geek2025&quot;</code> 对应位置相同，就算判定成功</p>
<p>而跟进另一个判定语句进入的是一个cleanup函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">cleanup</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+8h] [rbp-238h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+Ch] [rbp-234h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+10h] [rbp-230h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+14h] [rbp-22Ch]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+20h] [rbp-220h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+24h] [rbp-21Ch]</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">8</span>]; <span class="comment">// [rsp+28h] [rbp-218h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">256</span>]; <span class="comment">// [rsp+30h] [rbp-210h] BYREF</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">264</span>]; <span class="comment">// [rsp+130h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+238h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  fflush(_bss_start);</span><br><span class="line">  <span class="keyword">if</span> ( !fgets(s, <span class="number">256</span>, <span class="built_in">stdin</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  v1 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">0</span> &amp;&amp; s[v1 - <span class="number">1</span>] == <span class="number">10</span> )</span><br><span class="line">    s[--v1] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !validate_input_length(v1) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">7</span>; ++i )</span><br><span class="line">    v7[i] = global_nodes[<span class="number">16</span> * i];</span><br><span class="line">  <span class="keyword">if</span> ( !validate_key(v7, <span class="number">8LL</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, s, v1);</span><br><span class="line">  dest[v1] = <span class="number">0</span>;</span><br><span class="line">  compute_checksum(dest, v1);</span><br><span class="line">  stack_push(dest);</span><br><span class="line">  stack_push(v1);</span><br><span class="line">  stack_push(v7);</span><br><span class="line">  stack_push(<span class="number">8LL</span>);</span><br><span class="line">  stack_push(sub_44656);</span><br><span class="line">  stack_push(<span class="number">0LL</span>);</span><br><span class="line">  stack_push(<span class="number">4LL</span>);</span><br><span class="line">  reverse_call();</span><br><span class="line">  <span class="keyword">if</span> ( v1 != <span class="number">28</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">28</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( dest[j] != result[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v5 = calculate_crc32(dest, <span class="number">28LL</span>);</span><br><span class="line">  v6 = calculate_crc32(result, <span class="number">28LL</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v3 || v5 != v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    secure_memset(dest, <span class="number">0LL</span>, <span class="number">256LL</span>);</span><br><span class="line">    secure_memset(v7, <span class="number">0LL</span>, <span class="number">8LL</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Great!&quot;</span>);</span><br><span class="line">  secure_memset(dest, <span class="number">0LL</span>, <span class="number">256LL</span>);</span><br><span class="line">  secure_memset(v7, <span class="number">0LL</span>, <span class="number">8LL</span>);</span><br><span class="line">  <span class="keyword">return</span> v10 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里才是真正的加密逻辑，要求输入为28字节，然后调用sub_44656函数，最后与result进行比对，还另外匹配了<code>calculate_crc32(dest,28)</code>​ 与 <code>calculate_crc32(result,28)</code>（双重保险），都相等才算判定成功</p>
<p>跟进sub_44656函数，发现就是一个标准的RC4：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_44656</span><span class="params">(__int64 a1, <span class="type">int</span> a2, __int64 a3, <span class="type">int</span> a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-220h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+20h] [rbp-220h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+20h] [rbp-220h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+24h] [rbp-21Ch]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+24h] [rbp-21Ch]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+28h] [rbp-218h]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [rsp+2Ch] [rbp-214h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+2Ch] [rbp-214h]</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">520</span>]; <span class="comment">// [rsp+30h] [rbp-210h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v14; <span class="comment">// [rsp+238h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v14 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v13[i] = i;</span><br><span class="line">    v13[i + <span class="number">256</span>] = *(i % a4 + a3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">255</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (v13[j + <span class="number">256</span>] + v8 + v13[j]) % <span class="number">256</span>;</span><br><span class="line">    v11 = v13[j];</span><br><span class="line">    v13[j] = v13[v8];</span><br><span class="line">    v13[v8] = v11;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; a2; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = (v7 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v9 = (v9 + v13[v7]) % <span class="number">256</span>;</span><br><span class="line">    v12 = v13[v7];</span><br><span class="line">    v13[v7] = v13[v9];</span><br><span class="line">    v13[v9] = v12;</span><br><span class="line">    *(k + a1) ^= v13[(v13[v7] + v13[v9])];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v14 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>密钥就是之前的geek2025，密文是result，可以解密了</p>
<p>EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        out.append(byte ^ K)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">bytes</span>([</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x59</span>, <span class="number">0xF3</span>, <span class="number">0x8A</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xE6</span>, <span class="number">0x56</span>,</span><br><span class="line">    <span class="number">0x36</span>, <span class="number">0xE5</span>, <span class="number">0xF0</span>, <span class="number">0x33</span>, <span class="number">0x40</span>, <span class="number">0x6E</span>, <span class="number">0x56</span>, <span class="number">0x81</span>,</span><br><span class="line">    <span class="number">0x5A</span>, <span class="number">0xE5</span>, <span class="number">0x6F</span>, <span class="number">0x87</span>, <span class="number">0x6F</span>, <span class="number">0x9F</span>, <span class="number">0x21</span>, <span class="number">0xC9</span>,</span><br><span class="line">    <span class="number">0xA6</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>, <span class="number">0x51</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;geek2025&quot;</span></span><br><span class="line"></span><br><span class="line">flag = rc4_decrypt(data, key)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;50_y0u_pl@y_Gensh1n_too&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="8-QYQSの奇妙冒险2"><a href="#8-QYQSの奇妙冒险2" class="headerlink" title="8.QYQSの奇妙冒险2"></a>8.QYQSの奇妙冒险2</h2><p>ida打开文件，发现主函数跟上一题长得差不多，不信邪解了一次，果然是错的</p>
<p>然后开始动调</p>
<p>经过测试，在主函数最后一句<code>return 0;</code>上下个断点，然后直接让代码跑完</p>
<p>这时候再回头去定位跳转到验证成功的代码位置，发现居然有三个不同的判定</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763297949214-20251116205923-73y4oop.png" alt="QQ_1763297949214"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251116210129-uiw3nqf.png" alt="image"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763298327106-20251116210530-ummmt9j.png" alt="QQ_1763298327106"></p>
<p>但在我的动调过程中，我没发现它有运行进入过第三层判定的代码，所以仔细检索一下第三层判定代码，发现其中unk_7FF603C0F000对应的数据即为真正的flag</p>
<p>（事后推测应该是藏有一个SMC之类的自解密算法）</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763298436025-20251116210718-txlmkrl.png" alt="QQ_1763298436025"></p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{M@y_bE_y0u_F1nd?}</span></p>
<p>‍</p>
<h2 id="9-stack-bomb"><a href="#9-stack-bomb" class="headerlink" title="9.stack_bomb"></a>9.stack_bomb</h2><p>拿到文件，发现主函数没法反编译，看汇编中间应该是加了段混淆</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763299321477-20251116212207-ljk2o04.png" alt="QQ_1763299321477"></p>
<p>但是在混淆前面还有一串调用函数，一个一个跟进查看函数作用</p>
<p>整理得：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">push    offset loc_411307    <span class="comment">//a2 + a1;</span></span><br><span class="line">push    offset sub_41109B    <span class="comment">//a1 - a2;</span></span><br><span class="line">push    offset sub_4113F2    <span class="comment">//a2 ^ a1;</span></span><br><span class="line">push    offset loc_411186    <span class="comment">//a2 &amp; a1;</span></span><br><span class="line">push    offset sub_41115E    <span class="comment">//a1 &lt;&lt; a2;</span></span><br><span class="line">push    offset sub_411091    <span class="comment">//a1 &gt;&gt; a2;</span></span><br><span class="line">push    offset sub_4112D0    <span class="comment">//a1 % a2;</span></span><br><span class="line">push    offset sub_411163    <span class="comment">//a2 * a1;</span></span><br><span class="line">push    offset sub_411005    <span class="comment">//a1 / a2;</span></span><br></pre></td></tr></table></figure>

<p>然后继续往下分析，为了静态分析代码，先把混淆nop掉</p>
<p>主函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">v16[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">v16[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">v16[<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">v16[<span class="number">3</span>] = <span class="number">4</span>;</span><br><span class="line">sub_4110E6(<span class="string">&quot;plz input your ans:\n&quot;</span>, v4);</span><br><span class="line">_acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">v0 = sub_41127B();</span><br><span class="line">fgets(Buffer, <span class="number">33</span>, v0);</span><br><span class="line"><span class="keyword">if</span> ( sub_41127B() )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">strcspn</span>(Buffer, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  v6 = sub_41127B();</span><br><span class="line">  <span class="keyword">if</span> ( v6 &gt;= <span class="number">0x21</span> )</span><br><span class="line">    sub_411050();</span><br><span class="line">  Buffer[v6] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(Buffer) == <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    j_memcpy(v10, Buffer, <span class="number">8u</span>);</span><br><span class="line">    j_memcpy(v9, v12, <span class="number">8u</span>);</span><br><span class="line">    j_memcpy(v8, v13, <span class="number">8u</span>);</span><br><span class="line">    j_memcpy(v7, v14, <span class="number">8u</span>);</span><br><span class="line">    (v10[<span class="number">3</span>])();</span><br><span class="line">    (sub_411014)(v10, v16);</span><br><span class="line">    (sub_411014)(v9, v16);</span><br><span class="line">    (sub_411014)(v8, v16);</span><br><span class="line">    (sub_411014)(v7, v16);</span><br><span class="line">    <span class="keyword">if</span> ( v10[<span class="number">0</span>] == <span class="number">0x9A8C0C4B</span></span><br><span class="line">      &amp;&amp; v10[<span class="number">1</span>] == <span class="number">0xC412FF1C</span></span><br><span class="line">      &amp;&amp; v9[<span class="number">0</span>] == <span class="number">0xBFC3A488</span></span><br><span class="line">      &amp;&amp; v9[<span class="number">1</span>] == <span class="number">0xB16C8FD0</span></span><br><span class="line">      &amp;&amp; v8[<span class="number">0</span>] == <span class="number">0x4136E319</span></span><br><span class="line">      &amp;&amp; v8[<span class="number">1</span>] == <span class="number">0x8835E4FF</span></span><br><span class="line">      &amp;&amp; v7[<span class="number">0</span>] == <span class="number">0x118263A7</span></span><br><span class="line">      &amp;&amp; v7[<span class="number">1</span>] == <span class="number">0x7C85D629</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4110E6(<span class="string">&quot;You are right!&quot;</span>, v15);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      sub_4110E6(<span class="string">&quot;No  it&#x27;s  wrong&quot;</span>, v15);</span><br><span class="line">    &#125;</span><br><span class="line">    LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_4110E6(<span class="string">&quot;len wrong\n&quot;</span>, v5);</span><br><span class="line">    LODWORD(v1) = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  sub_4110E6(aError, v5);</span><br><span class="line">  LODWORD(v1) = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">v3 = v1;</span><br><span class="line">sub_411217(&amp;savedregs, &amp;dword_41236C);</span><br><span class="line"><span class="keyword">return</span> v3;</span><br></pre></td></tr></table></figure>

<p>这段主函数看密文像一个tea，跟进sub_411014函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">v71 = *a1;</span><br><span class="line">v70 = *(a1 + <span class="number">4</span>);</span><br><span class="line">v69 = <span class="number">0</span>;</span><br><span class="line">v67 = *DWORD1(a1);</span><br><span class="line">v66 = *(DWORD1(a1) + <span class="number">4</span>);</span><br><span class="line">v65 = *(DWORD1(a1) + <span class="number">8</span>);</span><br><span class="line">v64 = *(DWORD1(a1) + <span class="number">12</span>);</span><br><span class="line">v59 = <span class="number">1</span>;</span><br><span class="line">v68 = STACK[<span class="number">0x294</span>];</span><br><span class="line"><span class="keyword">while</span> ( v59 )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    STACK[<span class="number">0x26C</span>] = a1;</span><br><span class="line">    STACK[<span class="number">0x268</span>] = *(&amp;a1 + <span class="number">1</span>);</span><br><span class="line">    STACK[<span class="number">0x264</span>] = v69;</span><br><span class="line">    STACK[<span class="number">0x260</span>] = DWORD1(a1);</span><br><span class="line">    STACK[<span class="number">0x25C</span>] = *(&amp;a1 + <span class="number">5</span>);</span><br><span class="line">    STACK[<span class="number">0x258</span>] = *(&amp;a1 + <span class="number">6</span>);</span><br><span class="line">    STACK[<span class="number">0x254</span>] = *(&amp;a1 + <span class="number">7</span>);</span><br><span class="line">    STACK[<span class="number">0x250</span>] = dword_41B198;</span><br><span class="line">    v69 = (STACK[<span class="number">0x2C0</span>])(STACK[<span class="number">0x250</span>], STACK[<span class="number">0x264</span>]);</span><br><span class="line">    v48 = (STACK[<span class="number">0x2B0</span>])(v70, STACK[<span class="number">0x284</span>]);</span><br><span class="line">    v60 = (STACK[<span class="number">0x2C0</span>])(v67, v48);</span><br><span class="line">    v49 = (STACK[<span class="number">0x2C0</span>])(v69, v70);</span><br><span class="line">    v61 = (STACK[<span class="number">0x2B8</span>])(v49, v60);</span><br><span class="line">    v50 = (STACK[<span class="number">0x2AC</span>])(v70, STACK[<span class="number">0x280</span>]);</span><br><span class="line">    v51 = (STACK[<span class="number">0x2C0</span>])(v66, v50);</span><br><span class="line">    v52 = (STACK[<span class="number">0x2B8</span>])(v61, v51);</span><br><span class="line">    v71 = (STACK[<span class="number">0x2C0</span>])(v71, v52);</span><br><span class="line">    v53 = (STACK[<span class="number">0x2B0</span>])(v71, STACK[<span class="number">0x284</span>]);</span><br><span class="line">    v62 = (STACK[<span class="number">0x2C0</span>])(v65, v53);</span><br><span class="line">    v54 = (STACK[<span class="number">0x2C0</span>])(v69, v71);</span><br><span class="line">    v63 = (STACK[<span class="number">0x2B8</span>])(v54, v62);</span><br><span class="line">    v55 = (STACK[<span class="number">0x2AC</span>])(v71, STACK[<span class="number">0x280</span>]);</span><br><span class="line">    v56 = (STACK[<span class="number">0x2C0</span>])(v64, v55);</span><br><span class="line">    v57 = (STACK[<span class="number">0x2B8</span>])(v63, v56);</span><br><span class="line">    v70 = (STACK[<span class="number">0x2C0</span>])(v70, v57);</span><br><span class="line">    <span class="keyword">if</span> ( v68 &gt;= a48 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v68;</span><br><span class="line">  &#125;</span><br><span class="line">  v59 = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">*a1 = v71;</span><br><span class="line">*(a1 + <span class="number">4</span>) = v70;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>代码中出现了一大堆STACK[…]的内容，在动调的辅助下慢慢看每个STACK对应的操作分别是什么，然后把他们整理下来</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> part1 = *(<span class="type">uint32_t</span>*)ptr = STACK[<span class="number">0x26C</span>];         </span><br><span class="line"><span class="type">uint32_t</span> part2 = *(<span class="type">uint32_t</span>*)(ptr+<span class="number">4</span>) = STACK[<span class="number">0x268</span>];    </span><br><span class="line"><span class="type">uint32_t</span> k0 = *(<span class="type">uint32_t</span>*)(*(<span class="type">uint32_t</span>*)ptr + <span class="number">0</span>) = <span class="number">1</span>;</span><br><span class="line"><span class="type">uint32_t</span> k1 = *(<span class="type">uint32_t</span>*)(*(<span class="type">uint32_t</span>*)ptr + <span class="number">4</span>) = <span class="number">2</span>;</span><br><span class="line"><span class="type">uint32_t</span> k2 = *(<span class="type">uint32_t</span>*)(*(<span class="type">uint32_t</span>*)ptr + <span class="number">8</span>) = <span class="number">3</span>;</span><br><span class="line"><span class="type">uint32_t</span> k3 = *(<span class="type">uint32_t</span>*)(*(<span class="type">uint32_t</span>*)ptr + <span class="number">12</span>) = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> sum = STACK[<span class="number">0x264</span>] = <span class="number">0</span>;    </span><br><span class="line"><span class="type">uint32_t</span> rconstA = STACK[<span class="number">0x284</span>] = <span class="number">4</span>;</span><br><span class="line"><span class="type">uint32_t</span> rconstB = STACK[<span class="number">0x280</span>] = <span class="number">5</span>;</span><br><span class="line"><span class="type">uint32_t</span> delta = STACK[<span class="number">0x250</span>] = <span class="number">0x9000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> round = <span class="number">0</span>; round &lt;= rounds_limit; ++round) &#123;</span><br><span class="line">   sum = sub_0x2C0(delta, sum);  +   </span><br><span class="line"></span><br><span class="line">   t0 = sub_0x2B0(part2, rconstA); &lt;&lt; <span class="number">4</span></span><br><span class="line">   t1 = sub_0x2C0(k0, t0);  + <span class="number">1</span></span><br><span class="line">   t2 = sub_0x2C0(sum, part2); +</span><br><span class="line">   t3 = sub_0x2B8(t2, t1);  ^</span><br><span class="line"></span><br><span class="line">   t4 = sub_0x2AC(part2, rconstB); &gt;&gt; <span class="number">5</span></span><br><span class="line">   t5 = sub_0x2C0(k1, t4); +  <span class="number">2</span></span><br><span class="line">   t6 = sub_0x2B8(t3, t5); ^</span><br><span class="line"></span><br><span class="line">   part1 = sub_0x2C0(part1, t6); +</span><br><span class="line"></span><br><span class="line">   t7 = sub_0x2B0(part1, rconstA); &lt;&lt; <span class="number">4</span></span><br><span class="line">   t8 = sub_0x2C0(k2, t7);   + <span class="number">3</span></span><br><span class="line">   t9 = sub_0x2C0(sum, part1);  +</span><br><span class="line">   t10 = sub_0x2B8(t9, t8);  ^</span><br><span class="line"></span><br><span class="line">   t11 = sub_0x2AC(part1, rconstB);  &gt;&gt; <span class="number">5</span></span><br><span class="line">   t12 = sub_0x2C0(k3, t11);   + <span class="number">4</span></span><br><span class="line">   t13 = sub_0x2B8(t10, t12); ^</span><br><span class="line"></span><br><span class="line">   part2 = sub_0x2C0(part2, t13); +</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*(<span class="type">uint32_t</span>*)ptr = part1;</span><br><span class="line">*(<span class="type">uint32_t</span>*)(ptr+<span class="number">4</span>) = part2;</span><br></pre></td></tr></table></figure>

<p>再把这些整理成可读的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">sum += delta;</span><br><span class="line">t0= part2 &lt;&lt; <span class="number">4</span>;</span><br><span class="line">t1= t0 + k0;</span><br><span class="line">t2= sum + part2;</span><br><span class="line">t3= t1 ^ t2;</span><br><span class="line"></span><br><span class="line">t4= part2 &gt;&gt; <span class="number">5</span>;</span><br><span class="line">t5= t4 + k1;</span><br><span class="line">t6= t5 ^ t3;</span><br><span class="line"></span><br><span class="line">part1 += t6;</span><br><span class="line"></span><br><span class="line">t7= part1 &lt;&lt; <span class="number">4</span>;</span><br><span class="line">t8= t7 + k2;</span><br><span class="line">t9= part1 + sum;</span><br><span class="line">t10= t9 ^ t8;</span><br><span class="line"></span><br><span class="line">t11= part1 &gt;&gt; <span class="number">5</span>;</span><br><span class="line">t12= t11 + k3;</span><br><span class="line">t13= t12 ^ t10;</span><br><span class="line"></span><br><span class="line">part2 += t13;</span><br><span class="line"></span><br><span class="line">sum += delta;</span><br><span class="line"></span><br><span class="line">part1 += (((part2 &lt;&lt; <span class="number">4</span>) + k0) ^ (sum + part2)) ^ ((part2 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">part2 += (((part1 &lt;&lt; <span class="number">4</span>) + k2) ^ (part1 + sum)) ^ ((part1 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">delta =<span class="number">0x9000000</span></span><br><span class="line">key [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>很显然一个标准tea算法的模样就出来了</p>
<p>最后就是提取主函数里的密文写解密代码了</p>
<p><strong>EXP:</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">tea_decrypt</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">uint32_t</span> *k)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> part1 = v[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> part2 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x9000000</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = delta * <span class="number">32</span>;</span><br><span class="line">    <span class="type">int</span> i; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        part2 -= (((part1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (part1 + sum)) ^ ((part1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]);</span><br><span class="line">        part1  -= (((part2 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (part2 + sum)) ^ ((part2 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>] = part1;</span><br><span class="line">    v[<span class="number">1</span>] = part2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> enc[][<span class="number">2</span>] = </span><br><span class="line">	&#123;</span><br><span class="line">        &#123;<span class="number">0x9A8C0C4B</span>, <span class="number">0xC412FF1C</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0xBFC3A488</span>, <span class="number">0xB16C8FD0</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0x4136E319</span>, <span class="number">0x8835E4FF</span>&#125;,</span><br><span class="line">        &#123;<span class="number">0x118263A7</span>, <span class="number">0x7C85D629</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> flag[<span class="number">4</span> * <span class="number">8</span> + <span class="number">1</span>]; </span><br><span class="line">    <span class="type">char</span> *b = flag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        tea_decrypt(enc[i], key);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            *b++ = (enc[i][<span class="number">0</span>] &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            *b++ = (enc[i][<span class="number">1</span>] &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *b = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, flag);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//syc&#123;QYQS_F1nD_Th3_@nswer_H3re~~&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="10-ez-vm"><a href="#10-ez-vm" class="headerlink" title="10.ez_vm"></a>10.ez_vm</h2><p>ida打开，联系题目就知道是vm虚拟机的题目</p>
<p>主函数里可以看到两个函数名明显有问题的函数</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763387351692-20251117214916-d3n2j5s.png" alt="QQ_1763387351692"></p>
<p>先找找有没有可疑的字符串，比如密文或者opcode</p>
<p>在sub_5c6d7e的位置找到了疑似密文的字符串</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388161314-20251117220249-j5vzfuy.png" alt="QQ_1763388161314"></p>
<p>在sub_1a2b3c函数下面看到了一次vm，其中的string_process_program就是这一轮vm的opcode</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251117220606-bpvszwq.png" alt="image"></p>
<p>同理在sub_9e8f7a函数里找到了第二轮vm的opcode——xor_compare_program</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388442246-20251117220726-kop20h0.png" alt="QQ_1763388442246"></p>
<p>由两个opcode定义的不同名称猜测这个题应该是有两轮不同的加密逻辑，其中一轮是异或</p>
<p>然后再跟进去分析vm的具体实现，发现也存在两段不同的vm实现逻辑</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388683059-20251117221126-zh15xks.png" alt="QQ_1763388683059"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763388703915-20251117221147-walwhhy.png" alt="QQ_1763388703915"></p>
<p>介于vm本身的麻烦性和代码的复杂性，我选择边调试边理清代码的运行顺序和加密逻辑，通过几次调试对比opcode</p>
<p>最后整理出两段opcode对应的汇编及反汇编代码（参考了ai的分析）：</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/image-20251117221822-9pix98j.png" alt="image"></p>
<p>贴上两段整理好的汇编：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x01</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x02</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x1D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x03</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x05</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x06</span>,   <span class="number">0x01</span>, <span class="number">0x02</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">CMP</span></span><br><span class="line"><span class="number">0x08</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JZ</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x06</span>, <span class="number">0x05</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x06</span>, <span class="number">0x01</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x0E</span>,   <span class="number">0x00</span>, <span class="number">0x06</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   LDB（从代码区按索引读 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x00</span>, <span class="number">0x03</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span>  <span class="number">3</span></span><br><span class="line"><span class="number">0x0F</span>,   <span class="number">0x06</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   STB（向代码区按索引写 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x07</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JMP</span><br><span class="line"><span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>    HALT</span><br></pre></td></tr></table></figure>

<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x01</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x02</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x03</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x5A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   MOV（这里赋值的就是异或常量）</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x04</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x05</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x07</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"></span><br><span class="line"><span class="number">0x06</span>,   <span class="number">0x01</span>, <span class="number">0x02</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">CMP</span></span><br><span class="line"><span class="number">0x08</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JZ（相等跳转）</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x06</span>, <span class="number">0x05</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x06</span>, <span class="number">0x01</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x0E</span>,   <span class="number">0x00</span>, <span class="number">0x06</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   LDB（从代码区按索引读 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x10</span>,   <span class="number">0x00</span>, <span class="number">0x03</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   XOR  <span class="number">0x5A</span></span><br><span class="line"><span class="number">0x0F</span>,   <span class="number">0x06</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   STB（向代码区按索引写 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x07</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x06</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JMP</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x06</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x1D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x06</span>,   <span class="number">0x02</span>, <span class="number">0x06</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">CMP</span></span><br><span class="line"><span class="number">0x09</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JNZ（不等跳转）</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x07</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x06</span>,   <span class="number">0x01</span>, <span class="number">0x02</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">CMP</span></span><br><span class="line"><span class="number">0x08</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x24</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JZ</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x06</span>, <span class="number">0x07</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x06</span>, <span class="number">0x01</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x0E</span>,   <span class="number">0x00</span>, <span class="number">0x06</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   LDB（从代码区按索引读 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x0A</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">PUSH</span></span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x06</span>, <span class="number">0x05</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x06</span>, <span class="number">0x01</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x0E</span>,   <span class="number">0x00</span>, <span class="number">0x06</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   LDB（从代码区按索引读 <span class="number">1</span> 字节）</span><br><span class="line"><span class="number">0x0B</span>,   <span class="number">0x06</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">POP</span></span><br><span class="line"><span class="number">0x06</span>,   <span class="number">0x06</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">CMP</span></span><br><span class="line"><span class="number">0x09</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JNZ</span><br><span class="line"><span class="number">0x02</span>,   <span class="number">0x01</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">ADD</span></span><br><span class="line"><span class="number">0x07</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   JMP</span><br><span class="line"><span class="number">0x01</span>,   <span class="number">0x04</span>, <span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="keyword">MOV</span></span><br><span class="line"><span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   HALT</span><br><span class="line"><span class="number">0xFF</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>,   <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,   HALT</span><br></pre></td></tr></table></figure>

<p>第二段异或的值也可以动调出来</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-11-17%20215909-20251117220036-aw58zv4.png" alt="屏幕截图 2025-11-17 215909"></p>
<p>所以总之就是进行了一个加3和一个异或0x5A的操作，用cyberchef就能解了</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763387917243-20251117215842-tq1vz21.png" alt="QQ_1763387917243"></p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{W31c0m3_t0_r3@1_r3verse!}</span></p>
<p>‍</p>
<h2 id="11-GeekBinder"><a href="#11-GeekBinder" class="headerlink" title="11.GeekBinder"></a>11.GeekBinder</h2><p>文件包里有个docker，先看so文件</p>
<p>代码很少，打开就能看见疑似密文的内容</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !a1 || !a2 )</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0xFFFFFFFFL</span>L;</span><br><span class="line">v3 = <span class="built_in">malloc</span>(<span class="number">0x5Bu</span>LL);</span><br><span class="line"><span class="keyword">if</span> ( !v3 )</span><br><span class="line">  <span class="keyword">return</span> <span class="number">4294967294LL</span>;</span><br><span class="line">*v3 = <span class="number">0x7C725E7310263C34L</span>L;</span><br><span class="line">v3[<span class="number">1</span>] = <span class="number">0x5D666F5505541F1EL</span>L;</span><br><span class="line">v3[<span class="number">2</span>] = <span class="number">0x4601535D19153A54L</span>L;</span><br><span class="line">v3[<span class="number">3</span>] = <span class="number">0x4266037034165614L</span>L;</span><br><span class="line">v3[<span class="number">4</span>] = <span class="number">0x505E5974340B0002L</span>L;</span><br><span class="line">v3[<span class="number">5</span>] = <span class="number">0x5B5D536D18543A54L</span>L;</span><br><span class="line">v3[<span class="number">6</span>] = <span class="number">0x5A666F4B19251713L</span>L;</span><br><span class="line">v3[<span class="number">7</span>] = <span class="number">0x6A5E705F19550B38L</span>L;</span><br><span class="line">v3[<span class="number">8</span>] = <span class="number">0x651594608251717L</span>L;</span><br><span class="line">v3[<span class="number">9</span>] = <span class="number">0x506D5560340B5438L</span>L;</span><br><span class="line">v3[<span class="number">10</span>] = <span class="number">0x440555705540209L</span>L;</span><br><span class="line">*(v3 + <span class="number">44</span>) = <span class="number">521</span>;</span><br><span class="line">*(v3 + <span class="number">90</span>) = <span class="number">24</span>;</span><br><span class="line">*a1 = v3;</span><br><span class="line">*a2 = <span class="number">91LL</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0LL</span>;</span><br></pre></td></tr></table></figure>

<p>再检索一下代码还能找到一处异或处理：  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">attr_xor_cipher</span><span class="params">(__int64 a1, <span class="type">size_t</span> a2, _QWORD *a3, <span class="type">size_t</span> *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v7; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 || !a2 || !a3 || !a4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFFL</span>L;</span><br><span class="line">  v7 = <span class="built_in">malloc</span>(a2);</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4294967294LL</span>;</span><br><span class="line">  sub_1119(a1, a2, v7);</span><br><span class="line">  *a3 = v7;</span><br><span class="line">  *a4 = a2;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进一下sub_1119:  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">sub_1119</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+20h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(a3 + i) = *(a1 + i) ^ aGeek2025[i % <span class="number">8</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中引用的key是geek2025，然后就可以直接写解密代码了</p>
<p><strong>EXP:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">enc = [</span><br><span class="line">    <span class="number">0x7C725E7310263C34</span>,</span><br><span class="line">    <span class="number">0x5D666F5505541F1E</span>,</span><br><span class="line">    <span class="number">0x4601535D19153A54</span>,</span><br><span class="line">    <span class="number">0x4266037034165614</span>,</span><br><span class="line">    <span class="number">0x505E5974340B0002</span>,</span><br><span class="line">    <span class="number">0x5B5D536D18543A54</span>,</span><br><span class="line">    <span class="number">0x5A666F4B19251713</span>,</span><br><span class="line">    <span class="number">0x6A5E705F19550B38</span>,</span><br><span class="line">    <span class="number">0x0651594608251717</span>,</span><br><span class="line">    <span class="number">0x506D5560340B5438</span>,</span><br><span class="line">    <span class="number">0x0440555705540209</span>,</span><br><span class="line">]</span><br><span class="line">key = <span class="string">b&quot;geek2025&quot;</span></span><br><span class="line">data = <span class="string">b&#x27;&#x27;</span>.join(x.to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> enc)</span><br><span class="line"></span><br><span class="line">dec = <span class="built_in">bytes</span>(b ^ key[i % <span class="built_in">len</span>(key)] <span class="keyword">for</span> i, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(data))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dec)</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;An@Iyz1ng_Th3_proc3ss3s_B3Tween_File3_1s_contr@ry_To_n0rm@l_pr@ctic3_1n_Re_eng1neer1&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="12-obfuscat3"><a href="#12-obfuscat3" class="headerlink" title="12.obfuscat3"></a>12.obfuscat3</h2><p>主函数是很简洁明了的代码，但是关键加密函数（obf_encode）里加了混淆（但是这个带混淆的代码直接给ai它也能分析OvO）</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763644582880-20251120211630-i13tpbx.png" alt="QQ_1763644582880"></p>
<p>函数里又调用了init_encode和exchange_encode</p>
<p>具体审核分析代码看起来是有个魔改后又拆分加了混淆的RC4，进行了自定义的S盒流密码变体，其中init_encode函数实现了KSA的功能，exchange_encode函数实现了swap的功能，而obf_encode应该是实现了PRGA的功能，RC4算法的魔改点是把最后<code>char ^ S[(S[i] + S[j]) % 256]</code>​中的异或运算改成了  <strong>+</strong>  ，所以解密的时候只要改成  <strong>-</strong>  就行了</p>
<p>ai的分析是：用了很多复杂的布尔式&#x2F;按位算术把标准的 <code>j = j + S[i] + key[i%len]</code>​ 和 <code>i++</code>​／<code>idx = S[(S[i] + S[j]) &amp; 0xFF]</code> 等简单操作包裹、隐藏起来</p>
<p>然后就可以写解密代码了</p>
<p><strong>EXP:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">cipher = [</span><br><span class="line">  <span class="number">0xB4</span>, <span class="number">0xCD</span>, <span class="number">0x69</span>, <span class="number">0x54</span>, <span class="number">0xBD</span>, <span class="number">0x67</span>, <span class="number">0x20</span>, <span class="number">0x9D</span>, <span class="number">0xF2</span>, <span class="number">0xC3</span>,</span><br><span class="line">  <span class="number">0x24</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x1B</span>, <span class="number">0xE9</span>, <span class="number">0x6A</span>, <span class="number">0x44</span>, <span class="number">0x14</span>, <span class="number">0x4E</span>, <span class="number">0x39</span>,</span><br><span class="line">  <span class="number">0xC5</span>, <span class="number">0xC8</span>, <span class="number">0x5B</span>, <span class="number">0x11</span>, <span class="number">0x75</span>, <span class="number">0xAD</span>, <span class="number">0xDE</span>, <span class="number">0xBB</span>, <span class="number">0xFE</span>, <span class="number">0xE4</span>,</span><br><span class="line">  <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x06</span>, <span class="number">0x9A</span>, <span class="number">0x91</span>, <span class="number">0xFE</span>, <span class="number">0xA0</span>, <span class="number">0x68</span>, <span class="number">0xA4</span>, <span class="number">0x86</span>,</span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x6C</span>, <span class="number">0x0A</span>, <span class="number">0xCF</span>, <span class="number">0x1E</span>, <span class="number">0x67</span>, <span class="number">0xE3</span>, <span class="number">0x0D</span>, <span class="number">0x60</span>, <span class="number">0x47</span>,</span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0x6B</span>, <span class="number">0xD1</span>, <span class="number">0x36</span>, <span class="number">0xF2</span>, <span class="number">0x77</span>, <span class="number">0x58</span>, <span class="number">0x76</span>, <span class="number">0x1E</span>, <span class="number">0x98</span>,</span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0x7F</span>, <span class="number">0x0A</span>, <span class="number">0x92</span>, <span class="number">0xB7</span>, <span class="number">0x0A</span>, <span class="number">0xEA</span>, <span class="number">0xAE</span>, <span class="number">0x46</span>, <span class="number">0x7E</span>,</span><br><span class="line">  <span class="number">0x6A</span>, <span class="number">0x18</span>, <span class="number">0x4A</span>, <span class="number">0x59</span>, <span class="number">0x4E</span>, <span class="number">0x71</span>, <span class="number">0xB2</span>, <span class="number">0xE1</span>, <span class="number">0x41</span>, <span class="number">0x7A</span>,</span><br><span class="line">  <span class="number">0x0B</span>, <span class="number">0x31</span>, <span class="number">0xBA</span>, <span class="number">0xC6</span>, <span class="number">0xAA</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0x09</span>, <span class="number">0xBF</span>, <span class="number">0x2E</span>,</span><br><span class="line">  <span class="number">0xF8</span>, <span class="number">0x4D</span>, <span class="number">0x75</span>, <span class="number">0xEF</span>, <span class="number">0x14</span>, <span class="number">0xED</span>, <span class="number">0x5F</span>, <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x6F</span>,</span><br><span class="line">  <span class="number">0xDE</span>, <span class="number">0xE2</span>, <span class="number">0x7C</span>, <span class="number">0x10</span>, <span class="number">0x8C</span>, <span class="number">0xB7</span>, <span class="number">0x4E</span>, <span class="number">0x6B</span>, <span class="number">0xB2</span>, <span class="number">0xD4</span>,</span><br><span class="line">  <span class="number">0xF6</span>, <span class="number">0x91</span>, <span class="number">0xD7</span>, <span class="number">0x84</span>, <span class="number">0x86</span>, <span class="number">0x1F</span>, <span class="number">0xF8</span>, <span class="number">0x65</span>, <span class="number">0x94</span>, <span class="number">0x0B</span>,</span><br><span class="line">  <span class="number">0x14</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0xDD</span>, <span class="number">0x47</span>, <span class="number">0xF4</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>, <span class="number">0x42</span>, <span class="number">0x3F</span>,</span><br><span class="line">  <span class="number">0x1E</span>, <span class="number">0x38</span>, <span class="number">0x07</span>, <span class="number">0xBB</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0x12</span>, <span class="number">0x0C</span>, <span class="number">0x16</span>, <span class="number">0x68</span>,</span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x23</span>, <span class="number">0x12</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0xD9</span>, <span class="number">0x71</span>, <span class="number">0x7A</span>, <span class="number">0x88</span>, <span class="number">0xD0</span>,</span><br><span class="line">  <span class="number">0x46</span>, <span class="number">0x28</span>, <span class="number">0x88</span>, <span class="number">0xAD</span>, <span class="number">0x1E</span>, <span class="number">0x98</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x7E</span>, <span class="number">0x0E</span>,</span><br><span class="line">  <span class="number">0x69</span>, <span class="number">0x29</span>, <span class="number">0x37</span>, <span class="number">0xB1</span>, <span class="number">0xFF</span>, <span class="number">0xC5</span>, <span class="number">0xAF</span>, <span class="number">0x6F</span>, <span class="number">0x41</span>, <span class="number">0x37</span>,</span><br><span class="line">  <span class="number">0x65</span>, <span class="number">0x0E</span>, <span class="number">0xD2</span>, <span class="number">0x62</span>, <span class="number">0x11</span>, <span class="number">0x8F</span>, <span class="number">0xA6</span>, <span class="number">0x3E</span>, <span class="number">0x95</span>, <span class="number">0xF5</span>,</span><br><span class="line">  <span class="number">0x80</span>, <span class="number">0x9A</span>, <span class="number">0xDC</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;Samsara&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_keystream</span>(<span class="params">length, key_bytes</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="comment"># KSA</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key_bytes[i % <span class="built_in">len</span>(key_bytes)]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="comment"># PRGA</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        j = (j + S[i]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) &amp; <span class="number">0xFF</span>]</span><br><span class="line">        out.append(K)</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">ks = rc4_keystream(<span class="built_in">len</span>(cipher), <span class="built_in">list</span>(key))</span><br><span class="line">plain = <span class="built_in">bytes</span>((c - ks[i]) &amp; <span class="number">0xFF</span> <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher))</span><br><span class="line"><span class="built_in">print</span>(plain.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;Alright_I_sti1l_h0pe_th3t_you_solved_the_chall3nge_by_deobfuscating_them_Geek_is_just_the_first_step_of_your_CTF_journey_Im_glad_I_could_be_part_of_your_growth_Good_luck_for_y0u!&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="13-reReverse"><a href="#13-reReverse" class="headerlink" title="13.reReverse"></a>13.reReverse</h2><p>代码很简单，但看不出什么东西，后面看汇编看到有没反编译出来的内容，明显有判断对错的字符串</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763645334307-20251120212857-v3ky6f0.png" alt="QQ_1763645334307"></p>
<p>然后把这一大段汇编丢给gpt分析，分析出是一个xxtea</p>
<p>在如下汇编的位置能看到四个重复出现的字符串，就是xxtea的密钥</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646347158-20251120214557-1iuyhwr.png" alt="QQ_1763646347158"></p>
<p>在大段汇编的最开始也出现了经典的delta数值</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646560527-20251120214935-ou0eado.png" alt="QQ_1763646560527"></p>
<p>而密文也能在这段很长的汇编中间找到</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763646909695-20251120215515-co1w7be.png" alt="QQ_1763646909695"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763647029474-20251120215713-u27y25l.png" alt="QQ_1763647029474"></p>
<p>而这几个密文具体的加密比对顺序在密钥的位置能看见（也可以调试起来看）</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763647305144-20251120220155-m0cf4sr.png" alt="QQ_1763647305144"></p>
<p>然后取一段分析加密式子</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">A1</span>                 <span class="keyword">mov</span>     r12d, r10d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">A4</span>                 <span class="keyword">add</span>     r13d, r12d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>A7                 <span class="keyword">mov</span>     r14d, [rsp+<span class="number">28</span>h]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>AC                 xor     r12d, r14d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>AF                 shr     r12d, <span class="number">3</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>B3                 <span class="keyword">mov</span>     r12d, r10d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>B6                 xor     r13d, r12d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>B9                 shl     r14d, <span class="number">4</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>BD                 shr     r13d, <span class="number">5</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">C1</span>                 <span class="keyword">mov</span>     r14d, ebp</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">C4</span>                 <span class="keyword">mov</span>     r13d, ebp</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">C7</span>                 lea     r12d, ds:<span class="number">0</span>[<span class="built_in">r10</span>*<span class="number">4</span>]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>CF                 <span class="keyword">add</span>     ebp, r12d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">D2</span>                 xor     r12d, r13d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">D5</span>                 <span class="keyword">add</span>     r13d, r14d</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span><span class="built_in">D8</span>                 xor     r14d, ebx</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00000000004009</span>DB                 xor     r13d, r11d</span><br></pre></td></tr></table></figure>

<p>最后贴上解密代码</p>
<p><strong>EXP:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># 解密 10×u32（40 字节）XXTEA/CBTEA，得到明文（flag）</span></span><br><span class="line"></span><br><span class="line">DELTA = <span class="number">0x9E3779B9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MX</span>(<span class="params">z, y, s, k, p, e</span>):</span><br><span class="line">    <span class="comment"># Corrected Block TEA 的核心混合项</span></span><br><span class="line">    <span class="keyword">return</span> (((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((s ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">btea</span>(<span class="params">v, k, decode=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;v: list[int] (u32), k: 4×u32 key, decode=True 走解密&quot;&quot;&quot;</span></span><br><span class="line">    v = <span class="built_in">list</span>(v)</span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> decode:  <span class="comment"># 加密（用于回测）</span></span><br><span class="line">        q = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        z = v[n-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">            s = u32(s + DELTA)</span><br><span class="line">            e = (s &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">                y = v[p + <span class="number">1</span>]</span><br><span class="line">                v[p] = u32(v[p] + MX(z, y, s, k, p, e)); z = v[p]</span><br><span class="line">            y = v[<span class="number">0</span>]</span><br><span class="line">            v[n-<span class="number">1</span>] = u32(v[n-<span class="number">1</span>] + MX(z, y, s, k, n-<span class="number">1</span>, e))</span><br><span class="line">            z = v[n-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    <span class="keyword">else</span>:          <span class="comment"># 解密</span></span><br><span class="line">        q = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">        s = u32(q * DELTA)</span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">            e = (s &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">                z = v[p - <span class="number">1</span>]</span><br><span class="line">                v[p] = u32(v[p] - MX(z, y, s, k, p, e))</span><br><span class="line">                y = v[p]</span><br><span class="line">            z = v[n-<span class="number">1</span>]</span><br><span class="line">            v[<span class="number">0</span>] = u32(v[<span class="number">0</span>] - MX(z, y, s, k, <span class="number">0</span>, e))</span><br><span class="line">            y = v[<span class="number">0</span>]</span><br><span class="line">            s = u32(s - DELTA)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pack_le32</span>(<span class="params">arr</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&quot;&quot;</span>.join(<span class="built_in">int</span>(x).to_bytes(<span class="number">4</span>, <span class="string">&quot;little&quot;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> arr)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># rodata:401090 -&gt; 4×u32（小端）</span></span><br><span class="line">    k = [<span class="number">0x0000DEAD</span>, <span class="number">0x0000BEEF</span>, <span class="number">0x00005A7D</span>, <span class="number">0x0000C0FF</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 汇编对比顺序：r9d, edi, esi, ecx, edx, r8d, ebx, ebp, r11d, r10d</span></span><br><span class="line">    target = [</span><br><span class="line">        <span class="number">0x2973BD37</span>, <span class="number">0x1BA99AA3</span>, <span class="number">0xB3C20088</span>, <span class="number">0xBFC393AB</span>, <span class="number">0x352ADCCF</span>,</span><br><span class="line">        <span class="number">0x3B98E6E6</span>, <span class="number">0xAE421991</span>, <span class="number">0xD7B702CF</span>, <span class="number">0x0EEF6889</span>, <span class="number">0x08662435</span>,</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密得到明文（程序期望的 40 字节输入）</span></span><br><span class="line">    plain_u32 = btea(target, k, decode=<span class="literal">True</span>)</span><br><span class="line">    plain = pack_le32(plain_u32)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;plain u32:&quot;</span>, [<span class="string">f&quot;0x<span class="subst">&#123;v:08x&#125;</span>&quot;</span> <span class="keyword">for</span> v <span class="keyword">in</span> plain_u32])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;plain hex:&quot;</span>, plain.<span class="built_in">hex</span>())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        txt = plain.decode(<span class="string">&quot;ascii&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span>, txt)</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;bytes (non-ascii):&quot;</span>, plain)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反向回测（确保实现无误）</span></span><br><span class="line">    <span class="keyword">assert</span> btea(plain_u32.copy(), k, decode=<span class="literal">False</span>) == target</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="comment">#SYC&#123;sakurakouji_runasama_wa_seikai_ichi&#125;</span></span><br></pre></td></tr></table></figure>

<p>‍</p>
<h2 id="14-国产の光"><a href="#14-国产の光" class="headerlink" title="14.国产の光"></a>14.国产の光</h2><p>鸿蒙逆向，用魔改jadx反编译abc文件，在Index里找到密文和两个疑似密钥的内容</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763952784994-20251124105310-nfymkbr.png" alt="QQ_1763952784994"></p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763952845080-20251124105413-6jqg280.png" alt="QQ_1763952845080"></p>
<p>然后ida打开so文件，看见了一个AES和一个base58，AES的密钥和iv就是前面在jadx里找到的那两个</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953166186-20251124105946-ufzqudd.png" alt="QQ_1763953166186"></p>
<p>跟进base58发现码表被换了</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953279455-20251124110126-b85ussm.png" alt="QQ_1763953279455"></p>
<p>然后cyberchef解密就行</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763953319456-20251124110206-ktibpep.png" alt="QQ_1763953319456"></p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{HarmonyOS_1s_right?right!}</span></p>
<p>‍</p>
<h2 id="15-Lastone"><a href="#15-Lastone" class="headerlink" title="15.Lastone"></a>15.Lastone</h2><p>ida打开审计代码，在主函数就能看见密文的赋值</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979168895-20251124181254-9ekuzt8.png" alt="QQ_1763979168895"></p>
<p>然后跟进对buffer进行处理的sub_5A1032函数，审计代码</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979348287-20251124181554-og3lvbn.png" alt="QQ_1763979348287"></p>
<p>在sub_5A11DB函数里是vm虚拟机的switch循环函数，相应的unk_5AC040就是opcode</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979427301-20251124181714-034gyqp.png" alt="QQ_1763979427301"></p>
<p>对照分析了一下opcode：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">0x10,   0x00,  0x12,  0x00, 0x00, 0x00,     r0 = 0x12</span><br><span class="line">0x10,   0x01,  0x34,  0x00, 0x00, 0x00,     r1 = 0x34</span><br><span class="line">0x23,   0x00,  0x03,  0x00, 0x00, 0x00,     r0 *= 3 (r0 = 0x36)</span><br><span class="line">0x22,   0x01,  0xAB,  0x00, 0x00, 0x00,     r1 ^= 0xAB</span><br><span class="line">0x40,   0x00, 0x01,                         r0 += r1</span><br><span class="line">0x10,   0x02,  0x07,  0x00, 0x00, 0x00,     r2 = 0x07</span><br><span class="line">0x10,   0x03,  0x11,  0x00, 0x00, 0x00,     r3 = 0x11</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0xAB,  0x00, 0x00, 0x00,     r0 = 0xAB</span><br><span class="line">0x10,   0x01,  0xCD,  0x00, 0x00, 0x00,     r1 = 0xCD</span><br><span class="line">0x2B,   0x00,  0x04,  0x00, 0x00, 0x00,     r0 = rol(r0, 4)</span><br><span class="line">0x2C,   0x01,  0x02,  0x00, 0x00, 0x00,     r1 = ror(r1, 2)</span><br><span class="line">0x22,   0x00,  0x55,  0x00, 0x00, 0x00,     r0 ^= 0x55</span><br><span class="line">0x10,   0x02,  0x09,  0x00, 0x00, 0x00,     r2 = 0x09</span><br><span class="line">0x10,   0x03,  0x22,  0x00, 0x00, 0x00,     r3 = 0x22</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0xFF,  0x00, 0x00, 0x00,     r0 = 0xFF</span><br><span class="line">0x10,   0x01,  0xAA,  0x00, 0x00, 0x00,     r1 = 0xAA</span><br><span class="line">0x26,   0x00,  0x02,  0x00, 0x00, 0x00,     r0 &lt;&lt; 2</span><br><span class="line">0x25,   0x00,  0x64,  0x00, 0x00, 0x00,     r0 %= 0x64</span><br><span class="line">0x20,   0x01,  0x11,  0x00, 0x00, 0x00,     r1 += 0x11</span><br><span class="line">0x10,   0x02,  0x0D,  0x00, 0x00, 0x00,     r2 = 0x0D</span><br><span class="line">0x10,   0x03,  0x33,  0x00, 0x00, 0x00,     r3 = 0x33</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0x11,  0x00, 0x00, 0x00,     r0 = 0x11</span><br><span class="line">0x10,   0x01,  0x22,  0x00, 0x00, 0x00,     r1 = 0x22</span><br><span class="line">0x28,   0x00,  0x0F,  0x00, 0x00, 0x00,     r0 &amp;= 0x0F</span><br><span class="line">0x29,   0x01,  0xF0,  0x00, 0x00, 0x00,     r1 |= 0xF0</span><br><span class="line">0x22,   0x00,  0x33,  0x00, 0x00, 0x00,     r0 ^= 0x33</span><br><span class="line">0x10,   0x02,  0x0E,  0x00, 0x00, 0x00,     r2 = 0x0E</span><br><span class="line">0x10,   0x03,  0x44,  0x00, 0x00, 0x00,     r3 = 0x44</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0xDE,  0x00, 0x00, 0x00,     r0 = 0xDE</span><br><span class="line">0x10,   0x01,  0xAD,  0x00, 0x00, 0x00,     r1 = 0xAD</span><br><span class="line">0x31,   0x00, 					            ++r0</span><br><span class="line">0x32,   0x01, 					            --r1</span><br><span class="line">0x30,   0x00, 0x01, 				        swap(r0, r1)</span><br><span class="line">0x20,   0x00,  0x10,  0x00, 0x00, 0x00,     r0 += 0x10</span><br><span class="line">0x10,   0x02,  0x02,  0x00, 0x00, 0x00,     r2 = 0x02</span><br><span class="line">0x10,   0x03,  0x55,  0x00, 0x00, 0x00,     r3 = 0x55</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  </span><br><span class="line">0x10,   0x00,  0xBE,  0x00, 0x00, 0x00,     r0 = 0xBE</span><br><span class="line">0x10,   0x01,  0xEF,  0x00, 0x00, 0x00,     r1 = 0xEF</span><br><span class="line">0x23,   0x00,  0x02,  0x00, 0x00, 0x00,     r0 *= 0x02</span><br><span class="line">0x24,   0x01,  0x03,  0x00, 0x00, 0x00,     r1 /= 0x03</span><br><span class="line">0x40,   0x00, 0x01, 				        r0 += r1</span><br><span class="line">0x10,   0x02,  0x0A,  0x00, 0x00, 0x00,     r2 = 0x0A</span><br><span class="line">0x10,   0x03,  0x66,  0x00, 0x00, 0x00,     r3 = 0x66</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0xCA,  0x00, 0x00, 0x00,     r0 = 0xCA</span><br><span class="line">0x10,   0x01,  0xFE,  0x00, 0x00, 0x00,     r1 = 0xFE</span><br><span class="line">0x2A,   0x00, 					            r0 = ~r0</span><br><span class="line">0x28,   0x00,  0xFF,  0x00, 0x00, 0x00,     r0 &amp;= 0xFF</span><br><span class="line">0x22,   0x01,  0x7F,  0x00, 0x00, 0x00,     r1 ^= 0x7F</span><br><span class="line">0x10,   0x02,  0x0F,  0x00, 0x00, 0x00,     r2 = 0x0F</span><br><span class="line">0x10,   0x03,  0x77,  0x00, 0x00, 0x00,     r3 = 0x77</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, </span><br><span class="line"></span><br><span class="line">0x10,   0x00,  0x99,  0x00, 0x00, 0x00,     r0 = 0x99</span><br><span class="line">0x10,   0x01,  0x88,  0x00, 0x00, 0x00,     r1 = 0x88</span><br><span class="line">0x20,   0x00,  0x11,  0x00, 0x00, 0x00,     r0 += 0x11</span><br><span class="line">0x21,   0x01,  0x08,  0x00, 0x00, 0x00,     r1 -= 0x08</span><br><span class="line">0x2B,   0x00,  0x03,  0x00, 0x00, 0x00,     r0 = rol(r0, 3)</span><br><span class="line">0x10,   0x02,  0x05,  0x00, 0x00, 0x00,     r2 = 0x05</span><br><span class="line">0x10,   0x03,  0x88,  0x00, 0x00, 0x00,     r3 = 0x88</span><br><span class="line">0xFF, 						                HALT</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00</span><br><span class="line">  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00</span><br></pre></td></tr></table></figure>

<p>这里算出来的8组r0, r1, r2, r3的值是用于下面funcs中最后一个参数算式中的，即<code>(v8 + v6 * v7) ^ (40503 * v9)</code></p>
<p>但是这一部分也可以直接动调跑出来：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. (0x9F + 0x11 * 0x07) ^ (0x9E37 * 0xD5)</span><br><span class="line">2. (0x40000033 + 0x22 * 0x09) ^ (0x9E37 * 0xAE5)</span><br><span class="line">3. (0xBB + 0x33 * 0x0D) ^ (0x9E37 * 0x14)</span><br><span class="line">4. (0xF2 + 0x44 * 0x0E) ^ (0x9E37 * 0x32)</span><br><span class="line">5. (0xDF + 0x55 * 0x02) ^ (0x9E37 * 0xBC)</span><br><span class="line">6. (0x4F + 0x66 * 0x0A) ^ (0x9E37 * 0x1CB)</span><br><span class="line">7. (0x81 + 0x77 * 0x0F) ^ (0x9E37 * 0x35)</span><br><span class="line">8. (0x80 + 0x88 * 0x05) ^ (0x9E37 * 0x550)</span><br></pre></td></tr></table></figure>

<p>这八个算式算出来的值就是异或的参数，但是我这里直接去试着异或解不出来</p>
<p>于是选择动态调试，直接把密文patch进去然后运行，但是这样运行得到的结果中存在乱码</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763979908746-20251124182514-oksn90w.png" alt="QQ_1763979908746"></p>
<p>前四位根据经验直接替换成SYC{，后面的几位乱码经过几次手动爆破和动调验证之后得出了真正的值（不知道是不是非预期解）</p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{1@St_0nE_THanKs_I_lOvE_y0U!}</span></p>
<p>‍</p>
<h2 id="16-ez-android"><a href="#16-ez-android" class="headerlink" title="16.ez_android"></a>16.ez_android</h2><p>安卓题，先安装到雷电模拟器运行看看，发现有三个输入框，应该是有三段flag</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994063478-20251124222106-rlaj2cg.png" alt="QQ_1763994063478"></p>
<p>然后jadx打开看看，在源码里找到了三个function函数，在资源文件里找到了三段密文</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994114984-20251124222157-uy4vy16.png" alt="QQ_1763994114984"></p>
<p>先看第一段，是一个标准的DES&#x2F;ECB&#x2F;NoPadding算法，密钥为12345678，但是对密文又进行了一次转16进制的操作</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994201035-20251124222325-xa8zfol.png" alt="QQ_1763994201035"></p>
<p>直接cyberchef解密就行</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994276847-20251124222441-royn4tl.png" alt="QQ_1763994276847"></p>
<p>看第二段，主逻辑在native层</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994314455-20251124222517-rzgb8y3.png" alt="QQ_1763994314455"></p>
<p>解压之后反编译so文件，虽然在Java这个函数下面没看到关键，但是在旁边的函数列表可以看到一个decrypt_xor函数</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994402266-20251124222648-x49rw7b.png" alt="QQ_1763994402266"></p>
<p>交叉引用回去也能看到它的调用情况</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994504134-20251124222829-bhe3xsc.png" alt="QQ_1763994504134"></p>
<p>分析一下调用的参数，发现异或的是一整段内容（看命名应该是一个so文件），异或的值为0xAA</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994647173-20251124223051-g37xzux.png" alt="QQ_1763994647173"></p>
<p>然后拿去cyberchef解密一下，解出来是一个elf文件</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763994956829-20251124223601-5zm16t8.png" alt="QQ_1763994956829"></p>
<p>反编译查看这个elf文件，是一个标准的RC4，密钥为mysecret</p>
<p>再拿去cyberchef解密就能得到第二段flag</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1763995060416-20251124223745-ogkuhm7.png" alt="QQ_1763995060416">最后看第三段，也是在native层</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764067987451-20251125185313-8tpiyue.png" alt="QQ_1764067987451"></p>
<p>ida打开分析代码，是个des算法</p>
<p>把des加密中的1改成0就变成解密了</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764068075022-20251125185441-8sdoswv.png" alt="QQ_1764068075022"></p>
<p>然后动调把密文patch进去，直接就能调出第三段flag</p>
<p><img src="https://raw.githubusercontent.com/Fairy-10124/picture/main/QQ_1764067918889-20251125185208-ep6acn3.png" alt="QQ_1764067918889"></p>
<p><span data-type="text" style="color: var(--b3-font-color5);">SYC{Th1s_1s_Th3_R3@1ly_F1ag!}</span></p>
<p>‍</p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://example.com/2025/10/06/Geek%202025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://example.com/2025/10/06/Geek%202025%EF%BC%88reverse%E6%96%B9%E5%90%91%EF%BC%89/";
            const title         = "「Geek 2025」";
            const excerpt       = `Geek 2025（reverse方向）1.ez_pyyy拿到一个pyc文件，直接丢给网页反编译
完整反编译出来的代码为：
1234567891011121314151617181920212223242526272829303132...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Reverse/" rel="tag">Reverse</a>
                </div>
                <div class="pull-date">
                    <time datetime="2025-11-30T07:37:56.647Z" itemprop="dateModified">最后编辑：2025-11-30</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            
            <div class="nav-next clearfix">
                <a title=" L3HCTF 2025" href="/2025/10/06/L3HCTF 2025/">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <!-- Keep for compatibility -->
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- New links -->
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2025 槐序十七's blog 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by 槐序十七.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
                    <div class="box theme-box" id="snow-switch">
                        <span class="fa fa-snowflake-o"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="3021057627"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>